<!DOCTYPE html>
<html>
  <head>
    <title>Twittler</title>
    <link rel="stylesheet" href="styles.css">
    <script src="jquery.js"></script>
    <script src="data_generator.js"></script>
  </head>
  <body>

    <div class="main">Twittler Feed</div>

    <div class = "currentView">all tweets</div>

    <div><button class="refreshButton">check for new tweets</button></div>

    <div class="twittlerFeed"></div>

    <script>

      $(document).ready(function(){

        //var $body = $('body');
        //$body.html('');

        var displayTweets = function(tweets) {
          var $twittlerFeed = $('.twittlerFeed');
          $twittlerFeed.html('');

          var index = tweets.length - 1;
          while(index >= 0){
            var tweet = tweets[index];
            var $tweet = $('<div class = "tweet">' + '<span class = "user">' + '@' + tweet.user + '</span>' + '<span class = "message">' + ': ' + tweet.message + '<span class = "timestamp">' + ' ' + tweet.created_at + '</span></div>');
            $tweet.appendTo($twittlerFeed);

            index -= 1;
          }
        };

        var refreshFeed = function() {
          $('.currentView').text('all tweets');
          $('.refreshButton').text('check for new tweets');
          displayTweets(streams.home);
        };

        var displayUserFeed = function(user) {
          $('.currentView').text(user + '\'s tweets');
          $('.refreshButton').text('return to main feed');
          displayTweets(streams.users[user]);    
        };

        // var displayTimestamp = function() {
        //   $('.timestamp').slideToggle('hello');
        // }

        displayTweets(streams.home);

        setInterval(function() {
          displayTweets(streams.home)
        }, 4000);

        $('.refreshButton').on('click', refreshFeed);

        $('.main').on('click', refreshFeed);

        $('.twittlerFeed').on('click', '.user', function(event) {
          //var user = $(this).text().slice(1);
          displayUserFeed($(this).text().slice(1));
        });

        // $('.twittlerFeed').on('click', '.timestamp', displayTimestamp);

      });

    </script>

  </body>
</html>